code borrowed from http://gyu.que.jp/private/jsfsk/